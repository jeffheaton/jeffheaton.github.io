<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Encog HyperNEAT Structure | Heaton Research</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="EncogNEAT Documentation  CPPN NetworksThe compositional pattern-producing network (CPPN) was invented by Stanley (2007) and is a variation of the artificial neural network. CPPN recognizes one biolog">
<meta property="og:type" content="website">
<meta property="og:title" content="Encog HyperNEAT Structure">
<meta property="og:url" content="https://www.heatonresearch.com/encog/neat/hyperneat_structure.html">
<meta property="og:site_name" content="Heaton Research">
<meta property="og:description" content="EncogNEAT Documentation  CPPN NetworksThe compositional pattern-producing network (CPPN) was invented by Stanley (2007) and is a variation of the artificial neural network. CPPN recognizes one biolog">
<meta property="og:locale">
<meta property="og:image" content="https://www.heatonresearch.com/images/encog/neat/cppn_activation.png">
<meta property="og:image" content="https://www.heatonresearch.com/images/encog/neat/cppn_rgb.png">
<meta property="og:image" content="https://www.heatonresearch.com/images/encog/neat/picbreeder-1.png">
<meta property="og:image" content="https://www.heatonresearch.com/images/encog/neat/picbreeder-2.png">
<meta property="og:image" content="https://www.heatonresearch.com/images/encog/neat/hyp-sandwich.png">
<meta property="og:image" content="https://www.heatonresearch.com/images/encog/neat/hyp_cppn.png">
<meta property="og:image" content="https://www.heatonresearch.com/images/encog/neat/hyp_boxes-11.png">
<meta property="og:image" content="https://www.heatonresearch.com/images/encog/neat/hyp_boxes-33.png">
<meta property="article:published_time" content="2025-01-20T12:40:04.989Z">
<meta property="article:modified_time" content="2025-01-20T12:40:04.989Z">
<meta property="article:author" content="Jeff Heaton">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.heatonresearch.com/images/encog/neat/cppn_activation.png">
<meta name="twitter:creator" content="@jeffheaton">
  
    <link rel="alternate" href="/atom.xml" title="Heaton Research" type="application/atom+xml">
  
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" integrity="sha384-XdYbMnZ/QjLh6iI4ogqCTaIjrFk87ip+ekIjefZch0Y+PvJ8CDYtEs1ipDmPorQ+" crossorigin="anonymous">

  
  

  

  
<link rel="stylesheet" href="/css/styles.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5393865-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  <script data-ad-client="ca-pub-6846576724383320" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><nav class="navbar navbar-inverse">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
        <a class="navbar-brand" href="/">Heaton Research</a>
      
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="main-menu-navbar">
      <ul class="nav navbar-nav">
        
          <li><a class=""
                 href="/about/">About</a></li>
        
          <li><a class=""
                 href="/jeff_heaton_projects.html">Projects</a></li>
        
          <li><a class=""
                 href="/book/">Books</a></li>
        
          <li><a class=""
                 href="/contact.html">Contact</a></li>
        
          <li><a class=""
                 href="/support.html">Support Me</a></li>
        
          <li><a class=""
                 href="/archives/">Archives</a></li>
        
      </ul>

      <!--
      <ul class="nav navbar-nav navbar-right">
        
          <li><a href="/atom.xml" title="RSS Feed"><i class="fa fa-rss"></i></a></li>
        
      </ul>
      -->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

  <div class="container">
    <h1>Encog HyperNEAT Structure</h1>
<div class="row">
    <div class="col-sm-12 blog-main">
      <article id="page-" class="article article-type-page" itemscope itemprop="blogPost">


  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li><a href="/encog/neat/">EncogNEAT Documentation</a></li>
</ul>
<h1 id="CPPN-Networks"><a href="#CPPN-Networks" class="headerlink" title="CPPN Networks"></a>CPPN Networks</h1><p>The compositional pattern-producing network (CPPN) was invented by Stanley (2007) and is a variation of the artificial neural network. CPPN recognizes one biologically plausible fact. In nature, genotypes and phenotypes are not identical. In other words, the genotype is the DNA blueprint for an organism. The phenotype is what actually results from that plan.</p>
<p>In nature, the genome is the instructions for producing a phenotype that is much more complex than the genotype. In the original NEAT, as seen in the last section, the genome describes link for link and neuron for neuron how to produce the phenotype. However, CPPN is different because it creates a population of special NEAT genomes. These genomes are special in two ways. First, CPPN doesn’t have the limitations of regular NEAT, which always uses a sigmoid activation function. CPPN can use any of the following activation functions:</p>
<ul>
<li>   Clipped linear</li>
<li>   Bipolar steepened sigmoid</li>
<li>   Gaussian</li>
<li>   Sine</li>
<li>   Others you might define</li>
</ul>
<p>You can see these activation functions in Figure 1:</p>
<p><strong>Figure 1: CPPN Activation Functions</strong><br><img src="/images/encog/neat/cppn_activation.png" alt="CPPN Activation Functions"></p>
<p>The second difference is that the NEAT networks produced by these genomes are not the final product. They are not the phenotype. However, these NEAT genomes do know how to create the final product.</p>
<p>The final phenotype is a regular NEAT network with a sigmoid activation function. We can use the above four activation functions only for the genomes. The ultimate phenotype always has a sigmoid activation function.</p>
<h2 id="CPPN-Phenotype"><a href="#CPPN-Phenotype" class="headerlink" title="CPPN Phenotype"></a>CPPN Phenotype</h2><p>CPPNs are typically used in conjunction with images, as the CPPN phenotype is usually an image.  Though images are the usual product of a CPPN, the only real requirement is that the CPPN compose something, thereby earning its name of compositional pattern-producing network. There are cases where a CPPN does not produce an image. The most popular non-image producing CPPN is HyperNEAT, which is discussed in the next section.</p>
<p>Creating a genome neural network to produce a phenotype neural network is a complex but worthwhile endeavor. Because we are dealing with a large number of input and output neurons, the training times can be considerable. However, CPPNs are scalable and can reduce the training times.</p>
<p>Once you have evolved a CPPN to create an image, the size of the image (the phenotype) does not matter. It can be 320x200, 640x480 or some other resolution altogether.  The image phenotype, generated by the CPPN will grow to the size needed.  As we will see in the next section, CPPNs give HyperNEAT the same sort of scalability.  </p>
<p>We will now look at how a CPPN, which is itself a NEAT network, produces an image, or the final phenotype.  The NEAT CPPN should have three input values: the coordinate on the horizontal axis (x), the coordinate on the vertical axis (y), and the distance of the current coordinate from the center (d).  Inputting d provides a bias towards symmetry. In biological genomes, symmetry is important.  The output from the CPPN corresponds to the pixel color at the x-coordinate and y-coordinate.  The CPPN specification only determines how to process a grayscale image with a single output that indicates intensity.  For a full-color image, you could use output neurons for red, green, and blue.  Figure 2 shows a CPPN for images:</p>
<p><strong>Figure 2: CPPN for Images</strong><br><img src="/images/encog/neat/cppn_rgb.png" alt="CPPN for Images"></p>
<p>You can query the above CPPN for every x-coordinate and y-coordinate needed.  Listing 1 shows the pseudocode that you can use to generate the phenotype:</p>
<p><strong>Listing 1: Generate CPPN Image</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def render_cppn(net,bitmap):</span><br><span class="line"></span><br><span class="line">  for y from 1 to bitmap.height:</span><br><span class="line">    for x from 1 to bitmap.width:</span><br><span class="line"># Normalize x and y to -1,1</span><br><span class="line">      norm_x = (2*(x/bitmap.width))-1</span><br><span class="line">      norm_y = (2*(y/bitmap.height))-1</span><br><span class="line"># Distance from center</span><br><span class="line">      d = sqrt( (norm_x/2)^2</span><br><span class="line">	    + (norm_y /2)^2 )</span><br><span class="line"># Call CPPN</span><br><span class="line">      input = [x,y,d]</span><br><span class="line">	  color = net.compute(input)</span><br><span class="line"># Output pixel</span><br><span class="line">	  bitmap.plot(x-1,y-1, color)</span><br></pre></td></tr></table></figure>

<p>The above code simply loops over every pixel and queries the CPPN for the color at that location.  The x-coordinate and y-coordinate are normalized to being between -1 and +1.  You can see this process in action at the Picbreeder website at following URL:</p>
<p><a target="_blank" rel="noopener" href="http://picbreeder.org/">http://picbreeder.org/</a></p>
<p>Depending on the complexity of the CPPN, this process can produce images similar to Figure 2:<br><strong>Figure 3: A CPPN-Produced Image (picbreeder.org)</strong><br><img src="/images/encog/neat/picbreeder-1.png" alt="Picbreeder"></p>
<p>Picbreeder allows you to select one or more parents to contribute to the next generation.  We selected the image that resembles a mouth, as well as the image to the right.  Figure 3 shows the subsequent generation that Picbreeder produced.</p>
<p><strong>Figure 3: A CPPN-Produced Image (picbreeder.org)</strong><br><img src="/images/encog/neat/picbreeder-2.png" alt="Picbreeder"></p>
<p>CPPN networks handle symmetry just like human bodies.  With two hands, two kidneys, two feet, and other body part pairs, the human genome seems to have a hierarchy of repeated features.  Instructions for creating an eye or various tissues do not exist. Fundamentally, the human genome does not have to describe every detail of an adult human being.  Rather, the human genome only has to describe how to build an adult human being by generalizing many of the steps.  This greatly simplifies the amount of information that is needed in a genome.<br>Another great feature of the image CPPN is that you can create the above images at any resolution and without retraining.  Because the x–coordinate and y–coordinate are normalized to between -1 and +1, you can use any resolution.</p>
<h1 id="HyperNEAT-Networks"><a href="#HyperNEAT-Networks" class="headerlink" title="HyperNEAT Networks"></a>HyperNEAT Networks</h1><p>HyperNEAT networks, invented by Stanley, D’Ambrosio, &amp; Gauci (2009), are based upon the CPPN; however, instead of producing an image, a HyperNEAT network creates another neural network.  Just like the CPPN in the last section, HyperNEAT can easily create much higher resolution neural networks without retraining.</p>
<h2 id="HyperNEAT-Substrate"><a href="#HyperNEAT-Substrate" class="headerlink" title="HyperNEAT Substrate"></a>HyperNEAT Substrate</h2><p>One interesting hyper-parameter of the HyperNEAT network is the substrate that defines the structure of a HyperNEAT network.  A substrate defines the x-coordinate and the y-coordinate for the input and output neurons.  Standard HyperNEAT networks usually employ two planes to implement the substrate. Figure 4 shows the sandwich substrate, one of the most common substrates:</p>
<p><strong>Figure 4: HyperNEAT Sandwich Substrate</strong><br><img src="/images/encog/neat/hyp-sandwich.png" alt="Picbreeder"></p>
<p>Together with the above substrate, a HyperNEAT CPPN is capable of creating the phenotype neural network.  The source plane contains the input neurons, and the target plane contains the output neurons.  The x-coordinate and the y-coordinate for each are in the -1 to +1 range.  There can potentially be a weight between each of the source neurons and every target neuron.  Figure 8.8 shows how to query the CPPN to determine these weights:</p>
<p><strong>Figure 5: Sandwich Substrate</strong><br><img src="/images/encog/neat/hyp_cppn.png" alt="Picbreeder"></p>
<p>The input to the CPPN consists of four values: x1, y1, x2, and y2. The first two values x1 and y1 specify the input neuron on the source plane.  The second two values x2 and y2 specify the input neuron on the target plane.  HyperNEAT allows the presence of as many different input and output neurons as desired, without retraining.  Just like the CPPN image could map more and more pixels between -1 and +1, so too can HyperNEAT pack in more input and output neurons.</p>
<h2 id="HyperNEAT-Computer-Vision"><a href="#HyperNEAT-Computer-Vision" class="headerlink" title="HyperNEAT Computer Vision"></a>HyperNEAT Computer Vision</h2><p>Computer vision is a great application of HyperNEAT, as demonstrated by the rectangles experiment provided in the original HyperNEAT paper by Stanley, Kenneth O., et al. (2009).  This experiment placed two rectangles in a computer’s vision field.  Of these two rectangles, one is always larger than the other.  The neural network is trained to place a red rectangle near the center of the larger rectangle.  Figure 8.9 shows this experiment running under the Encog framework:</p>
<p><strong>Figure 8.9: Boxes Experiment (11 resolution)</strong><br><img src="/images/encog/neat/hyp_boxes-11.png" alt="Picbreeder"></p>
<p>As you can see from the above image, the red rectangle is placed directly inside of the larger of the two rectangles.  The “New Case” button can be pressed to move the rectangles, and the program correctly finds the larger rectangle.  While this works quite well at 11x11, the size can be increased to 33x33.  With the larger size, no retraining is needed, as shown in Figure 6:</p>
<p><strong>Figure 6: Boxes Experiment (33 resolution)</strong><br><img src="/images/encog/neat/hyp_boxes-33.png" alt="Picbreeder"></p>
<p>When the dimensions are increased to 33x33, the neural network is still able to place the red square inside of the larger rectangle.</p>
<p>The above example uses a sandwich substrate with the input and output plane both equal to the size of the visual field, in this case 33x33. The input plane provides the visual field.  The neuron in the output plane with the highest output is the program’s guess at the center of the larger rectangle.  </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/encog/encog-dotnet-more-examples/tree/master/HyperNEATBoxes">Boxes Experiment in Encog C#</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/encog/encog-java-examples/tree/master/src/main/java/org/encog/examples/neural/neat/boxes">Boxes Experiment in Java</a></li>
</ul>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="https://www.heatonresearch.com/encog/neat/hyperneat_structure.html" data-id="cm651nwp700208vmtf6ur1w1t" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      

    </footer>
  </div>
  
    

  
</article>

    </div>
</div>

  </div>
  <footer class="blog-footer">
  <div class="container">
    <div id="footer-info" class="inner">
      &copy; 2025 by Heaton Research, Inc. - <a href="/legal/">Legal and Copyright Info</a><br>
Jeff Heaton is a computer scientist, data scientist, and indie publisher. Heaton Research is the homepage for his projects and research. <a href="/tips.html">Tips and support.</a><br><br>
<ul class="list-inline banner-social-buttons">
  <li><a class="btn btn-default btn-sm" target="_blank" rel="noopener" href="https://github.com/jeffheaton"><i class="fa fa-github"> <span class="network-name">GitHub</span></i></a></li>
  <li><a class="btn btn-default btn-sm" target="_blank" rel="noopener" href="https://twitter.com/jeffheaton"><i class="fa fa-twitter"> <span class="network-name">Twitter</span></i></a></li>
  <li><a class="btn btn-default btn-sm" target="_blank" rel="noopener" href="https://www.youtube.com/user/HeatonResearch"><i class="fa fa-youtube-play"> <span class="network-name">Youtube</span></i></a></li>
  <li><a class="btn btn-default btn-sm" target="_blank" rel="noopener" href="https://www.facebook.com/encog.framework/"><i class="fa fa-facebook"> <span class="network-name">Facebook</span></i></a></li>
</ul>

    </div>
  </div>
</footer>

  
<script>
  var disqus_shortname = 'heatonresearch';
  
  var disqus_url = 'https://www.heatonresearch.com/encog/neat/hyperneat_structure.html';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>









<script src="/js/script.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>
</html>
